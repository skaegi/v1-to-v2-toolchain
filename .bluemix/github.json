{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "title": "Github link",
    "description": "Github link schema",
    "longDescription": "Store your source code in an existing Git repository on GitHub.com and engage in social coding through wikis, issue tracking, and pull requests.",
    "type": "object",
    "properties": {
      "repo_url": {
          "type": "string",
          "title": "Source repository URL"
      },
      "existing_repo_url": {
          "type": "string",        
          "title": "Source repository URL"
      },    
      "type": {
        "type": "string",
        "title": "Repository type",
        "default": "Existing"
      },
      "has_issues": {
		"title": "Enable GitHub Issues",
		"description": "Enable GitHub's Issues page for lightweight issue tracking.",
		"type": "boolean",
		"default": true
      },
      "migrateTAndP": {
      	            "title": "Do you wish to migrate Track & Plan work-items to GitHub Issues",
	            "description": "Track & Plan work-items will be created as GitHub Issues in the existing repository",
	            "type": "boolean",
	            "enum": ["Yes", "No"]
      },
      "query": {
             "type": "string",
             "title": "You can select which WI can be transferred by specifying the name of a RTC Query.",
	     "description": "Work-items will be selected based on this query."
      },
      "labels": {
        "type": "object",
	      "title": "GitHub issues uses labels to track attributes. You can select which Track & Plan WI attributes to map to labels in your new GitHub issues here:",
        "properties": {
          "type": {"title": "type", "type": "boolean"},
          "severity": {"title": "severity", "type": "boolean"},
          "state": {"title": "state", "type": "boolean"},
          "priority": {"title": "priority", "type": "boolean"},
          "resolution": {"title": "resolution", "type": "boolean"},
          "filedAgainst": {"title": "filedAgainst", "type": "boolean"},
          "tags": {"title": "tags", "type": "boolean"}
        }
      }
    },
    "form": [        
      {
        "type": "validator",
        "url": "/devops/setup/bm-helper/github_helper.html"
      },  
      {
        "type": "string",
        "key": "type",
        "readonly": true
      }, {
      	"description": "The repository that your toolchain will link to.",
      	"type": "string",
      	"key": "existing_repo_url",
      	"readonly": true
      },{
      	"type": "group",
	"title": "Track & Plan Migration",
	"description": "Details for setting up the migration of your Track & Plan work items",
	"items" : [
		{
		  "type": "label",
		  "key": "desc",
		  "title": "Your newly created toolchain uses GitHub Issues for Issue tracking.  
			      
			To keep your existing Track & Plan data it must be transferred to GitHub Issues now. [Detailed info available here](https://console.ng.bluemix.net/docs/services/ContinuousDelivery/upgrade_projects.html)"	
		},
		 {
			"type": "selectfieldset",
			"key": "migrateTAndP",
			"readonly": true,
			"title-map": {
				 "Yes" : "Yes",
				 "No" : "No"
			},
			"items": [{
			       "type" : "section",
			       "description" : "",
			       "items" : ["query", "labels"]
			       }, {
			       "type" : "label",
			       "description" : "Track & Plan data will not be migrated."
			       }]
	      }
	
	]
      }
    ],
    "actions": {        
        "update": ["repo_url","has_issues"]
    }
}
